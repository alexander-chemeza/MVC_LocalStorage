<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Modal default</title>
    <link href="https://fonts.googleapis.com/css?family=Exo+2" rel="stylesheet">
    <style>
        body {
            margin: 0;
            background-color: #556;
            background-image: linear-gradient(30deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
                linear-gradient(150deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
                linear-gradient(30deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
                linear-gradient(150deg, #445 12%, transparent 12.5%, transparent 87%, #445 87.5%, #445),
                linear-gradient(60deg, #99a 25%, transparent 25.5%, transparent 75%, #99a 75%, #99a),
                linear-gradient(60deg, #99a 25%, transparent 25.5%, transparent 75%, #99a 75%, #99a);
            background-size: 80px 140px;
            background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px;
            font-family: 'Exo 2', sans-serif;
            box-sizing: border-box;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit;
        }

        .container {
            margin: 20px;
            padding: 20px;
            min-height: 600px;
            font-size: 16px;
            background-color: #fff;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 50;
            background: rgba(0, 0, 0, 0.6);
        }

        .modal-open {
            color: #fff;
            border: 1px #007bff solid;
            border-radius: 5px;
            padding: 8px 12px;
            font-size: 16px;
            font-family: 'Exo 2', sans-serif;
            background-color: #007bff;
            text-decoration: none;
        }

        .modal-open:hover {
            text-decoration: none;
            background-color: #0069d9;
            border-color: #0062cc;
        }

        .modal-open:active {
            text-decoration: none;
            background-color: #0062cc;
            border-color: #005cbf;
        }

        .modal {
            display: block;
            width: 600px;
            max-width: 100%;
            height: 400px;
            max-height: 100%;
            position: fixed;
            z-index: 100;
            left: 50%;
            top: 50%;
            border-radius: 10px;
            transform: translate(-50%, -50%);
            background: white;
            box-shadow: 0 0 60px 10px rgba(0, 0, 0, 0.9);
        }

        .modal_closed {
            display: none;
        }

        .modal__header {
            border-bottom: 1px gray solid;
            padding: 10px 15px;
            margin-bottom: 15px;
        }

        .modal__close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAEFCu8CAAAABGdBTUEAALGPC/xhBQAAAqpJREFUSA2tljtyFEEMhsdgHJpb2NyAxwkgcQHGHGE3Bs4B8RICV6G4ARSERH4QGaog4vF/qv7HWu3MzrqMqjR69C9puls9PV13QU9Rr13Y3Vfpf7GPxLdRROGw0hs43vHYFuM9wYAMOcbYaQ47u7fJgRMGFMkwIgyHyIDesNMgAD3dkvZDvGWPlSVUG4wxBu43h0HIGT4UO7Hv2EeoB1wCQPhYzi/i12JHSA26acWpLV96IMtDGQZU+TEDrT9qAb8lD8RnzXbwC9mL5vsjGbSvpwGnzWfB+5s8F7C/cLLSDrS8y0Ci+gbguutiBzxLYCoQkMm4D0NOD47JwVUl0Vz8U5wD38veFa8ldptDw9xpfhZvkj4JkStlnT1eoXxmMrjqHKUlYlMBsclsdg5gZWkKmgP/Q3EQi2Fgc/WNe2yH5IOKowscWDslxXV0lXF7DNiwzMEOpLLHkTHX7ECv3XKvBIH5Ll7KlOfEmIm3yAWeMEDf2Ylt+iYlv/Zz2cbR39FKdmBDeU4O5jMB7jMA0yspDp6SjunlJsE3enRROAGchFyVkzIruEmTT91cTLJ61GpyMGApfinioGwy3VxwSCcHudbS/yhUi5NzhXbl4QbJ4EVB0T65nYzF59ZyiFvMGFqNGkE0a25yg/KHuUFDkJxjB9dCAdAjHwbno0YcDP4s7KySt/dfh9RJ4gWGVsF54wgP3VMGWDKbenfl6nxYwBg/JuNjw8UwBsA/tEdyr9DU7MgVn8V9Kflj7OL8kY0tJ8nH9g9//mg7HzX2xEFzPT1g6V+pBglRZzE2+3y9ON8sJ0LnD8eXHCAus4X4QMyFt26PGAMDliPhi5A85OwvROlLtCOLdfZbXVWSi5wb0WOh+Nm7bFFiiL0S8btDc/HL80Z83hgdH2NgJukfa8ehuEonW4wAAAAASUVORK5CYII=');
            overflow: hidden;
            text-indent: -999em;
            text-decoration: none;
        }

        .modal__close:hover {
            background-color: #dc3545;
            text-decoration: none;
        }

        .modal__content {
            padding: 10px 15px;
            min-height: 200px;
        }

        .form-field {
            padding: 0 0 10px;
        }

        .form-field label {}

        .form-field input {
            border: 1px gray solid;
            border-radius: 5px;
            padding: 8px 12px;
            margin: 0 10px;
            font-size: 14px;
            font-family: 'Exo 2', sans-serif;
        }

        .form-field .input__default {
            width: 380px;
        }

        .form-field .input__date-birth {
            width: 100px;
            text-align: center;
        }

        .modal__footer {
            border-top: 1px gray solid;
            padding: 15px;
            margin-top: 15px;
            text-align: right;
        }

        .modal__footer button {
            border: 1px gray solid;
            border-radius: 5px;
            padding: 8px 12px;
            margin: 0 10px;
            font-size: 14px;
            font-family: 'Exo 2', sans-serif;
        }

        .modal__footer .modal__cancel {
            background-color: #dc3545;
            border-color: #dc3545;
            color: #fff;
        }

        .modal__footer .modal__cancel:hover {
            background-color: #c82333;
            border-color: #bd2130;
        }

        .modal__footer .modal__cancel:active {
            background-color: #bd2130;
            border-color: #b21f2d;
        }

        .modal__footer .modal__save {
            background-color: #28a745;
            border-color: #28a745;
            color: #fff;
        }

        .modal__footer .modal__save:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal__footer .modal__save:hover {
            background-color: #218838;
            border-color: #1e7e34;
        }

        .modal__footer .modal__save:active {
            background-color: #1e7e34;
            border-color: #1c7430;
        }

        .control {
            margin-top: 50px;
            text-align: center;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Создание простейшего модального окошка!</h1>

        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab
            illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab
            illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam fuga sunt voluptas, ullam, sed consequuntur ab
            illo veniam ad totam alias voluptatibus sequi officiis, unde autem reiciendis magnam labore voluptatum?</p>
        <div class="control">
            <a href="#" id="modal-open" class="modal-open" title="Покажите мне модальное окошко">Открыть окно</a>
        </div>

        <div class="modal-data"></div>
        <div class="control"><a href="#" id="clear-data" style="display: none;" class="clear-data">Очистить данные</a></div>
    </div>

    <div class="modal-overlay modal_closed" id="modal-overlay"></div>
    <div class="modal modal_closed" id="modal">
        <header class="modal__header">
            <a href="#" class="modal__close" id="modal-close" title="Закрыть модальное окно">Закрыть</a>
            <h2>Введите данные</h2>
        </header>

        <main class="modal__content">
            <div class="form-field">
                <label for="name">Ваше имя:</label>
                <input class="input__default" type="text" id="name" name="name">
            </div>
            <div class="form-field">
                <label>Ваш день рождения:</label>
                <input type="text" class="input__date-birth" id="birth-day" name="name" placeholder="День"> -
                <input type="text" class="input__date-birth" id="birth-month" name="name" placeholder="Месяц"> -
                <input type="text" class="input__date-birth" id="birth-year" name="name" placeholder="Год">
            </div>
        </main>

        <footer class="modal__footer">
            <button id="modal-cancel" class="modal__cancel" title="Отмена">Отмена</button>
            <button id="modal-save" class="modal__save" title="Сохранить">Сохранить данные</button>
        </footer>
    </div>

    <script>
        class Model {
            constructor(view) {
                this.view = view || new View();
            }

            checkFields() {
                this.view.check();
            }

            save() {
                this.view.saveData();
            }

            search() {
                this.view.show();
            }

            openClose() {
                this.view.toggle();
            }

            clear() {
                this.view.clearLocalStorage();
            }
        }

        class View {
            constructor() {
                this.modal = document.getElementById("modal");
                this.cancelButton = document.getElementById("modal-cancel");
                this.saveButton = document.getElementById("modal-save");
                this.saveButton.disabled = true;
                this.openButton = document.getElementById("modal-open");
                this.modalInputName = document.querySelector("#name");
                this.modalInputDay = document.querySelector("#birth-day");
                this.modalInputMonth = document.querySelector("#birth-month");
                this.modalInputYear = document.querySelector("#birth-year");
                this.modalOverlay = document.getElementById("modal-overlay");
                this.closeButton = document.getElementById("modal-close");
                this.inputs = document.getElementsByTagName("input");
                this.modalData = document.getElementsByClassName("modal-data");
                this.clearData = document.getElementById('clear-data');
            }

            toggle() {
                this.modal.classList.toggle("modal_closed");
                this.modalOverlay.classList.toggle("modal_closed");
                this.clearForm();
            }

            check() {
                let permission = 0;

                // Check inputs and change permission
                for (let input of this.inputs) {
                    if (input.value === "") {
                        permission = 0;
                    } else {
                        permission++;
                    }
                }

                // Check permission and enable button, if possible
                if (permission >= this.inputs.length) {
                    this.saveButton.disabled = false;
                } else {
                    this.saveButton.disabled = true;
                }
            }

            clearForm() {
                // Clear all fields
                this.modalInputName.value = "";
                this.modalInputDay.value = "";
                this.modalInputMonth.value = "";
                this.modalInputYear.value = "";
            }

            saveData() {
                // Deal with localStorage
                if (typeof localStorage !== "undefined") {
                    let userData = {
                        modalInputName: this.modalInputName.value,
                        modalInputDay: this.modalInputDay.value,
                        modalInputMonth: this.modalInputMonth.value,
                        modalInputYear: this.modalInputYear.value
                    }

                    window.localStorage.setItem("userData", JSON.stringify(userData));
                } else {
                    console.log("localStorage is not defined and you can try to use cookies");
                }

                // Close the modal window
                this.toggle();
                
                // Show content
                this.getInfo();
                this.clearData.style = "";
            }

            getInfo() {
                // Read localStorage
                let data = JSON.parse(localStorage.getItem("userData"));

                // Make output elements
                const greeting = document.createElement("p");
                const birthDay = document.createElement("p");

                // Fill output elements
                greeting.innerHTML = `Здравствуйте ${data.modalInputName}!`;
                birthDay.innerHTML = `Ваш день рождения ${data.modalInputDay} / ${data.modalInputMonth} / ${data.modalInputYear}.`;

                // Fill in the output block
                this.modalData[0].append(greeting);
                this.modalData[0].append(birthDay);
            }

            clearLocalStorage() {
                // Remove data
                localStorage.removeItem('userData');
                // Create feedback
                const feedback = "Данные пользователя удалены";
                const message = document.createElement("p");
                message.innerHTML = feedback;
                // Clear model-data block
                while (this.modalData[0].firstChild) {
                    this.modalData[0].removeChild(this.modalData[0].firstChild);
                }
                // Send feedback
                this.modalData[0].append(message);
            }

            show() {
                // Check localStorage and then show content
                let data = localStorage.getItem('userData');
                if(data) {
                    this.getInfo();
                    this.clearData.style = "";
                }
            }
        }

        class Controller {
            constructor(model, view) {
                this.model = model || new Model(new View());
                this.view = view || new View();
            }

            init() {
                // Open / cloase modal window
                this.view.openButton.addEventListener("click", e => {
                    e.preventDefault();
                    this.model.openClose();
                });

                this.view.closeButton.addEventListener("click", e => {
                    e.preventDefault();
                    this.model.openClose();
                });

                this.view.cancelButton.addEventListener("click", e => {
                    e.preventDefault();
                    this.model.openClose();
                });

                // Inputs check
                document.addEventListener("keyup", e => {
                    e.preventDefault();
                    this.model.checkFields();
                });

                // Update localStorage
                this.view.saveButton.addEventListener("click", e => {
                    e.preventDefault();
                    this.model.save();
                });

                // Clear localStorage
                this.view.clearData.addEventListener("click", e => {
                    e.preventDefault();
                    this.model.clear();
                });

                // Read localStorage
                document.addEventListener("DOMContentLoaded", () => {
                    this.model.search();
                });
            }
        }

        const saveToLocalModel = new Model(new View),
            saveToLocalView = new View(),
            saveToLocalController = new Controller(saveToLocalModel, saveToLocalView);

        saveToLocalController.init();
    </script>
</body>

</html>